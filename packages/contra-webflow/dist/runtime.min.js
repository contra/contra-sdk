"use strict";var ContraWebflow=(()=>{var E=Object.defineProperty;var P=Object.getOwnPropertyDescriptor;var L=Object.getOwnPropertyNames;var S=Object.prototype.hasOwnProperty;var M=(c,t)=>{for(var e in t)E(c,e,{get:t[e],enumerable:!0})},w=(c,t,e,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of L(t))!S.call(c,i)&&i!==e&&E(c,i,{get:()=>t[i],enumerable:!(a=P(t,i))||a.enumerable});return c};var T=c=>w(E({},"__esModule",{value:!0}),c);var A={};M(A,{ContraWebflowRuntime:()=>m,default:()=>m});var b=class p{constructor(t){this.cache=new Map,this.pendingRequests=new Map,this.config={baseUrl:"https://contra.com",timeout:1e4,debug:!1,...t},this.config.debug&&console.log("[ContraClient] Initialized with config:",this.config)}async fetch(t,e={},a=3){let i=`${this.config.baseUrl}${t}`,s=new AbortController,n=setTimeout(()=>s.abort(),this.config.timeout),o={...e,signal:s.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:this.config.apiKey,"X-API-Key":this.config.apiKey,...e.headers}};try{this.config.debug&&console.log(`[ContraClient] Fetching: ${i}`,o);let r=await fetch(i,o);if(clearTimeout(n),!r.ok){let d;try{d=await r.json()}catch{d={code:`HTTP_${r.status}`,message:r.statusText||"Unknown error"}}if((r.status>=500||r.status===429)&&a>0){let u=Math.pow(2,3-a)*1e3;return await new Promise($=>setTimeout($,u)),this.fetch(t,e,a-1)}throw new f(d.message,d.code,r.status)}let l=await r.json();return this.config.debug&&console.log("[ContraClient] Response:",l),l}catch(r){if(clearTimeout(n),r instanceof f)throw r;if(r instanceof Error&&r.name==="AbortError")throw new f(`Request timeout after ${this.config.timeout}ms`,"TIMEOUT");if(a>0){let l=Math.pow(2,3-a)*1e3;return await new Promise(d=>setTimeout(d,l)),this.fetch(t,e,a-1)}throw new f(r instanceof Error?r.message:"Unknown error","NETWORK_ERROR")}}async fetchWithCache(t,e,a,i){let s=this.cache.get(t);if(s&&Date.now()-s.timestamp<s.ttl)return this.config.debug&&console.log(`[ContraClient] Cache hit: ${t}`),s.data;let n=`${e}${JSON.stringify(i)}`;if(this.pendingRequests.has(n))return this.config.debug&&console.log(`[ContraClient] Request deduplication: ${n}`),this.pendingRequests.get(n);let o=this.fetch(e,i);this.pendingRequests.set(n,o);try{let r=await o;return this.cache.set(t,{data:r,timestamp:Date.now(),ttl:a}),r}finally{this.pendingRequests.delete(n)}}buildQueryString(t){let e=new URLSearchParams;Object.entries(t).forEach(([i,s])=>{s!=null&&s!==""&&(Array.isArray(s)?e.set(i,s.join(",")):e.set(i,String(s)))});let a=e.toString();return a?`?${a}`:""}async getProgram(t){let e=`program:${t}`,a=`/public-api/programs/${t}`;return(await this.fetchWithCache(e,a,p.CACHE_TTL.program)).data}async listExperts(t,e={}){let a=this.buildQueryString(e),i=`experts:${t}:${JSON.stringify(e)}`,s=`/public-api/programs/${t}/experts${a}`;return this.fetchWithCache(i,s,p.CACHE_TTL.experts)}async searchExperts(t,e,a={}){let i=await this.listExperts(t,a);if(e.trim()){let s=e.toLowerCase();i.data=i.data.filter(n=>n.name&&n.name.toLowerCase().includes(s)||n.oneLiner&&n.oneLiner.toLowerCase().includes(s)||n.skillTags&&n.skillTags.some(o=>o&&o.toLowerCase().includes(s)))}return i}async getFilterOptions(t){let e=`filters:${t}`,a=`/public-api/programs/${t}/filters`;return this.fetchWithCache(e,a,p.CACHE_TTL.filters)}clearCache(t){if(t)for(let e of this.cache.keys())e.includes(t)&&this.cache.delete(e);else this.cache.clear();this.config.debug&&console.log(`[ContraClient] Cache cleared${t?` (pattern: ${t})`:""}`)}getCacheStats(){let t=Date.now(),e=Array.from(this.cache.entries()).map(([a,i])=>({key:a,age:t-i.timestamp,ttl:i.ttl}));return{size:this.cache.size,entries:e}}};b.CACHE_TTL={experts:5*60*1e3,expert:10*60*1e3,program:30*60*1e3,filters:60*60*1e3};var C=b,f=class extends Error{constructor(c,t,e){super(c),this.code=t,this.status=e,this.name="ContraAPIError"}},x={formatRate(c){return c?`$${c}/hr`:"Rate on request"},renderStars(c){let t=Math.floor(c),e=c%1>=.5,a=5-t-(e?1:0),i="";for(let s=0;s<t;s++)i+=`<svg class="star star-full" width="16" height="16" viewBox="0 0 24 24" fill="#FFD700">
        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
      </svg>`;e&&(i+=`<svg class="star star-half" width="16" height="16" viewBox="0 0 24 24">
        <defs>
          <linearGradient id="half-${c}">
            <stop offset="50%" stop-color="#FFD700"/>
            <stop offset="50%" stop-color="#E5E5E5"/>
          </linearGradient>
        </defs>
        <path fill="url(#half-${c})" d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
      </svg>`);for(let s=0;s<a;s++)i+=`<svg class="star star-empty" width="16" height="16" viewBox="0 0 24 24" fill="#E5E5E5">
        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
      </svg>`;return i},debounce(c,t){let e;return(...a)=>{clearTimeout(e),e=setTimeout(()=>c(...a),t)}},throttle(c,t){let e;return(...a)=>{e||(c(...a),e=!0,setTimeout(()=>e=!1,t))}}};var h="data-contra-",g={program:"program",template:"template",loading:"loading",error:"error",empty:"empty",field:"field",format:"format",repeat:"repeat",max:"max",filter:"filter",filterType:"filter-type",available:"available",sort:"sort",page:"page",limit:"limit",paginationMode:"pagination-mode",infiniteLoading:"infinite-loading",paginationInfo:"pagination-info",showWhen:"show-when",hideWhen:"hide-when",action:"action",target:"target"},v=class{constructor(){this.states=new Map}getState(t){return this.states.has(t)||this.states.set(t,{filters:{},experts:[],loading:!1,error:null,currentPage:1,totalCount:0,cachedPages:new Map,loadingPages:new Set,hasNextPage:!1,hasPreviousPage:!1,isInfiniteLoading:!1,lastScrollPosition:0,paginationMode:"traditional",programId:""}),this.states.get(t)}updateState(t,e){let a=this.getState(t);Object.assign(a,e),this.states.set(t,a)}cachePage(t,e,a){let i=this.getState(t);if(i.cachedPages.set(e,a),i.cachedPages.size>5){let s=Math.min(...i.cachedPages.keys());i.cachedPages.delete(s)}}getCachedPage(t,e){return this.getState(t).cachedPages.get(e)||null}setPageLoading(t,e,a){let i=this.getState(t);a?i.loadingPages.add(e):i.loadingPages.delete(e)}isPageLoading(t,e){return this.getState(t).loadingPages.has(e)}},m=class{constructor(t){this.state=new v;this.debouncedReload=new Map;this.config={debug:!1,program:"",loadingClass:"loading",errorClass:"error",emptyClass:"empty",autoReload:!0,debounceDelay:300,maxRetries:3,paginationMode:"traditional",infiniteScrollThreshold:500,preloadNextPage:!0,maxCachedPages:5,smoothScrollBehavior:"auto",loadMoreText:"Load More",videoAutoplay:!1,videoHoverPlay:!0,videoMuted:!0,videoLoop:!0,videoControls:!1,...t},this.client=new C({apiKey:this.config.apiKey,debug:this.config.debug}),this.log("Runtime initialized",this.config)}async init(){this.log("Initializing runtime...");try{let t=this.findExpertContainers(),e=t.filter(a=>!a.hasAttribute("data-contra-initialized"));this.log(`Found ${e.length} uninitialised expert containers (${t.length} total)`);for(let a of e)await this.initContainer(a);this.log("Runtime initialization complete")}catch(t){throw this.log("Runtime initialization failed",t),t}}async initContainer(t){let e=this.config.program;if(!e){this.log("No program ID found in config",t);return}let a=document.querySelectorAll("[data-contra-limit], [data-contra-pagination]"),s=`container-${Array.from(a).indexOf(t)}`;this.log(`Initializing container ${s} for program: ${e}`);try{this.setupContainer(t,s,e),this.wireActionButtons(t,s),await this.loadExperts(t,s)}catch(n){this.log(`Failed to initialize container ${s}`,n),this.showError(t,n)}}setupContainer(t,e,a){let i=t;i.classList.add("contra-runtime"),i.setAttribute("data-contra-initialized","true"),i.setAttribute("data-container-id",e);let s=this.getAttr(t,"pagination")||"traditional",n=parseInt(this.getAttr(t,"limit")||"20");this.state.updateState(e,{filters:{limit:n,offset:0},paginationMode:s,experts:[],loading:!1,error:null,currentPage:1,totalCount:0,hasNextPage:!1,hasPreviousPage:!1,cachedPages:new Map,loadingPages:new Set,isInfiniteLoading:!1,lastScrollPosition:0,programId:a}),this.log(`Container ${e} setup complete:`,{paginationMode:s,limit:n})}wireFilterControls(t,e){let a=this.querySelectorAll(t,`[${h}${g.filter}]`);this.log(`Found ${a.length} filter controls for program: ${e}`),a.forEach(i=>{let s=this.getAttr(i,g.filter),n=this.getAttr(i,g.filterType)||"replace";if(s){if(i instanceof HTMLInputElement){let o=i.type==="range"||i.type==="number"?"input":"change";i.addEventListener(o,()=>{this.updateFilter(e,s,this.getControlValue(i),n),this.config.autoReload&&this.debouncedReload.get(e)?.()})}else i instanceof HTMLSelectElement&&i.addEventListener("change",()=>{this.updateFilter(e,s,this.getControlValue(i),n),this.config.autoReload&&this.debouncedReload.get(e)?.()});this.log(`Wired filter control: ${s} (${n})`,i)}})}wireActionButtons(t,e){this.querySelectorAll(t,`[${h}${g.action}]`).forEach(i=>{let s=this.getAttr(i,g.action),n=this.getAttr(i,g.target);s&&i.addEventListener("click",o=>{o.preventDefault(),this.handleAction(e,s,n,i)})})}async loadExperts(t,e,a=!1){let i=this.state.getState(e),s=i.programId;this.log(`Loading experts for container: ${e}, program: ${s}`,i.filters);try{this.showLoading(t,!0),this.state.updateState(e,{loading:!0,error:null});let n=await this.client.listExperts(s,i.filters);this.log(`Loaded ${n.data.length} experts`,n),i.paginationMode==="traditional"?this.handleTraditionalPaginationResponse(e,t,n):this.handleInfinitePaginationResponse(e,t,n)}catch(n){this.log(`Failed to load experts for container: ${e}`,n),this.state.updateState(e,{loading:!1,error:n}),this.showError(t,n),this.dispatchEvent(t,"expertsError",{error:n,context:`Loading experts for container ${e}`})}finally{this.showLoading(t,!1)}}handleTraditionalPaginationResponse(t,e,a){let i=this.state.getState(t),s=i.filters.limit||20,n=i.filters.offset||0,o=Math.floor(n/s)+1,r=Math.ceil(a.totalCount/s),l=o<r,d=o>1;this.state.updateState(t,{experts:a.data,totalCount:a.totalCount,currentPage:o,hasNextPage:l,hasPreviousPage:d,loading:!1}),this.state.cachePage(t,o,a.data),this.renderExperts(e,a.data),this.updateUIStates(e,t),this.updatePaginationControls(e,t),this.dispatchEvent(e,"expertsLoaded",{experts:a.data,totalCount:a.totalCount,filters:i.filters,page:o,totalPages:r,hasNextPage:l,hasPreviousPage:d,paginationMode:"traditional"}),this.log(`Traditional pagination: Page ${o}/${r}, ${a.data.length} experts loaded`)}handleInfinitePaginationResponse(t,e,a){let i=this.state.getState(t),s=i.experts.length>0,n=s?[...i.experts,...a.data]:a.data,o=n.length<a.totalCount;this.state.updateState(t,{experts:n,totalCount:a.totalCount,hasNextPage:o,hasPreviousPage:!1,loading:!1,isInfiniteLoading:!1}),s?this.renderNewExperts(e,a.data):this.renderExperts(e,a.data),this.updateUIStates(e,t),this.updatePaginationControls(e,t),this.dispatchEvent(e,"expertsLoaded",{experts:a.data,totalExperts:n,totalCount:a.totalCount,filters:i.filters,hasNextPage:o,isLoadMore:s,paginationMode:"infinite"}),this.log(`Infinite pagination: ${n.length}/${a.totalCount} experts loaded`)}calculateCurrentPage(t){let e=t.limit||20,a=t.offset||0;return Math.floor(a/e)+1}updatePaginationState(t,e,a,i){let s=i.limit||20,n=i.offset||0,o=Math.floor(n/s)+1,r=Math.ceil(a/s);this.state.updateState(t,{experts:e,totalCount:a,currentPage:o,hasNextPage:o<r,hasPreviousPage:o>1,loading:!1})}renderExperts(t,e){let a=this.querySelector(t,`[${h}${g.template}]`);if(!a){this.log("No template found in container",t);return}this.querySelectorAll(t,":scope > *:not([data-contra-template]):not([data-contra-loading]):not([data-contra-error]):not([data-contra-empty])").forEach(s=>s.remove()),e.forEach(s=>{let n=this.populateExpertCard(a,s);t.appendChild(n)}),this.log(`Rendered ${e.length} expert cards`)}populateExpertCard(t,e){let a=t.cloneNode(!0);return a.removeAttribute(`${h}${g.template}`),a.style.display="",this.populateFields(a,e),this.populateRepeatingElements(a,e),this.handleConditionalDisplay(a,e),a}populateFields(t,e){this.querySelectorAll(t,`[${h}${g.field}]`).forEach(s=>{let n=this.getAttr(s,g.field),o=this.getAttr(s,g.format);if(!n||!(n in e))return;let r=e[n];this.setElementValue(s,r,o)}),this.querySelectorAll(t,"[data-contra-stars]").forEach(s=>{e.averageReviewScore&&this.renderStarRating(s,e.averageReviewScore)})}setElementValue(t,e,a){if(!(e==null||e==="")){if(this.isMediaField(t)&&typeof e=="string"&&e.trim()){this.setMediaValue(t,e);return}if(t instanceof HTMLAnchorElement)t.href=String(e),t.textContent?.trim()||(t.textContent=String(e));else if(t instanceof HTMLInputElement)t.value=String(e);else if(t instanceof HTMLImageElement)t.src=String(e),t.alt=t.alt||"Image";else{let i=String(e);if(a)switch(a){case"currency":i=typeof e=="number"?`$${e}`:i;break;case"rate":i=x.formatRate(typeof e=="number"?e:null);break;case"rating":i=typeof e=="number"?e.toFixed(1):i;break;case"earnings":typeof e=="number"&&(e>=1e6?i=`$${Math.floor(e/1e6)}M+`:e>=1e3?i=`$${Math.floor(e/1e3)}k+`:i=`$${e}`);break;case"number":i=typeof e=="number"?e.toLocaleString():i;break;case"truncate":i=i.length>100?i.substring(0,97)+"...":i;break;case"boolean":i=e?"Yes":"No";break;case"availability":i=e?"Available":"Not Available";break}t.textContent=i}}}renderStarRating(t,e){let a=Math.floor(e),i=e%1>=.5,s=5-a-(i?1:0),n="";for(let r=0;r<a;r++)n+='<span class="contra-star contra-star-full">\u2605</span>';i&&(n+='<span class="contra-star contra-star-half">\u2605</span>');for(let r=0;r<s;r++)n+='<span class="contra-star contra-star-empty">\u2606</span>';t.innerHTML=n;let o=t.closest("[data-contra-template]")||t.closest(".expert-card");o&&this.querySelectorAll(o,"[data-contra-rating-text]").forEach(l=>{l.textContent=e.toFixed(1)})}isMediaField(t){return this.getAttr(t,g.field)==="coverUrl"}setMediaValue(t,e){let a=this.detectMediaType(e),i=t.parentElement;if(!i){this.log("Media element has no parent for replacement",t);return}t.remove();let s;switch(a){case"video":s=this.createVideoElement(e,t);break;case"image":default:s=this.createImageElement(e,t);break}this.transferAttributes(t,s),i.appendChild(s),this.log(`Created ${a} element for URL: ${e}`)}detectMediaType(t){if(!t||typeof t!="string")return this.log("Invalid URL provided to detectMediaType:",t),"image";let e=t.toLowerCase(),i=[".mp4",".webm",".mov",".avi",".mkv",".ogg"].some(n=>e.includes(n)),s=e.includes("cloudinary.com/")&&e.includes("/video/");return i||s?"video":"image"}createVideoElement(t,e){let a=document.createElement("video");return a.src=t,a.muted=this.config.videoMuted,a.loop=this.config.videoLoop,a.playsInline=!0,a.preload="metadata",a.controls=this.config.videoControls,a.style.width="100%",a.style.height="100%",a.style.objectFit="cover",a.style.borderRadius="inherit",this.config.videoAutoplay&&(a.autoplay=!0,a.setAttribute("autoplay","")),a.onerror=()=>{this.log(`Video failed to load: ${t}`);let i=this.extractVideoThumbnail(t);if(i){let s=this.createImageElement(i,e);a.parentElement?.replaceChild(s,a)}else a.style.background="#f3f4f6",a.style.position="relative",a.innerHTML='<div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#9ca3af;font-size:12px;">Video unavailable</div>'},this.config.videoHoverPlay&&!this.config.videoAutoplay&&(a.addEventListener("mouseenter",()=>{a.currentTime=0,a.play().catch(()=>{})}),a.addEventListener("mouseleave",()=>{a.pause(),a.currentTime=0})),a}createImageElement(t,e){let a=document.createElement("img");return a.src=t,a.alt=e.getAttribute("alt")||"Media content",a.loading="lazy",a.style.width="100%",a.style.height="100%",a.style.objectFit="cover",a.style.borderRadius="inherit",a.onerror=()=>{this.log(`Image failed to load: ${t}`),a.style.background="#f3f4f6",a.style.opacity="0.5",a.alt="Image unavailable",a.style.position="relative";let i=document.createElement("div");i.style.cssText=`
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: #9ca3af;
        font-size: 12px;
        text-align: center;
      `,i.textContent="\u{1F5BC}\uFE0F Image unavailable",a.parentElement?.appendChild(i)},a}extractVideoThumbnail(t){return t.includes("cloudinary.com/")&&t.includes("/video/")?t.replace("/video/","/image/").replace(/\.(mp4|webm|mov|avi|mkv)$/i,".jpg").replace("fl_progressive","f_auto,q_auto,c_fill"):null}transferAttributes(t,e){if(t.className&&(e.className=t.className),Array.from(t.attributes).forEach(a=>{a.name.startsWith("data-")&&a.name!==`${h}${g.field}`&&e.setAttribute(a.name,a.value)}),t.getAttribute("style")){let a=e.getAttribute("style")||"";e.setAttribute("style",a+"; "+t.getAttribute("style"))}}populateRepeatingElements(t,e){this.querySelectorAll(t,`[${h}${g.repeat}]`).forEach(i=>{let s=this.getAttr(i,g.repeat),n=parseInt(this.getAttr(i,g.max)||"10");s==="projects"&&e.projects?this.populateRepeatingContainer(i,e.projects.slice(0,n)):s==="socialLinks"&&e.socialLinks?this.populateRepeatingContainer(i,e.socialLinks.slice(0,n)):s==="skillTags"&&e.skillTags&&this.populateRepeatingContainer(i,e.skillTags.slice(0,n).map(o=>({name:o})))})}populateRepeatingContainer(t,e){let a=t.firstElementChild;a&&(t.innerHTML="",e.forEach(i=>{let s=a.cloneNode(!0);this.populateFields(s,i),t.appendChild(s)}),e.length===0&&(t.style.display="none"))}handleConditionalDisplay(t,e){this.querySelectorAll(t,`[${h}${g.showWhen}], [${h}${g.hideWhen}]`).forEach(i=>{let s=this.getAttr(i,g.showWhen),n=this.getAttr(i,g.hideWhen),o=!0;s&&(o=this.evaluateCondition(e,s)),n&&(o=o&&!this.evaluateCondition(e,n)),i.style.display=o?"":"none"})}evaluateCondition(t,e){if(!e||typeof e!="string")return this.log("Invalid condition provided:",e),!1;let a=e.split(":");if(a.length<2)return this.log("Invalid condition format:",e),!1;let i=a[0],s=a.slice(1).join(":"),n=t[i];if(this.log(`Evaluating condition: ${i} (${n}, type: ${typeof n}) against ${s}`),n==null)return this.log(`Field '${i}' is null/undefined, condition fails`),!1;if(s.startsWith(">=")){let o=s.substring(2),r=Number(n)>=Number(o);return this.log(`Comparison: ${n} >= ${o} = ${r}`),r}else if(s.startsWith("<=")){let o=s.substring(2),r=Number(n)<=Number(o);return this.log(`Comparison: ${n} <= ${o} = ${r}`),r}else if(s.startsWith(">")){let o=s.substring(1),r=Number(n)>Number(o);return this.log(`Comparison: ${n} > ${o} = ${r}`),r}else if(s.startsWith("<")){let o=s.substring(1),r=Number(n)<Number(o);return this.log(`Comparison: ${n} < ${o} = ${r}`),r}else{let o=!1;if(typeof n=="boolean")s.toLowerCase()==="true"?o=n===!0:s.toLowerCase()==="false"?o=n===!1:o=!1,this.log(`Boolean comparison: ${n} === ${s.toLowerCase()==="true"} = ${o}`);else if(typeof n=="number"){let r=Number(s);o=!isNaN(r)&&n===r,this.log(`Number comparison: ${n} === ${r} = ${o}`)}else{let r=String(n),l=String(s);o=r.toLowerCase()===l.toLowerCase(),this.log(`String comparison: '${r}' === '${l}' = ${o}`)}return o}}updateUIStates(t,e){let a=this.state.getState(e),i=this.querySelector(t,`[${h}${g.empty}]`);i&&(i.style.display=a.experts.length===0?"":"none"),this.querySelectorAll(t,"[data-contra-pagination-info]").forEach(o=>{let{currentPage:r,totalCount:l}=a,d=a.filters.limit||20,u=Math.ceil(l/d);o.textContent=`Page ${r} of ${u} (${l} total)`}),this.querySelectorAll(t,"[data-contra-filter-summary]").forEach(o=>{let r=Object.entries(a.filters).filter(([l,d])=>d!=null&&d!=="").map(([l,d])=>`${l}: ${d}`).join(", ");o.textContent=r||"No filters applied"})}handleAction(t,e,a,i){let s=this.state.getState(t),n=document.querySelector(`[data-container-id="${t}"]`);if(!n){this.log(`Container not found: ${t}`);return}i&&i instanceof HTMLButtonElement&&(i.disabled=!0);let o=s.filters.limit||20,r=s.filters.offset||0;switch(e){case"next-page":if(s.paginationMode==="traditional"){let l=r+o;l<s.totalCount&&(this.updateFilter(t,"offset",l),this.loadExperts(n,t,!0))}else this.loadMoreExperts(n,t);break;case"prev-page":if(s.paginationMode==="traditional"){let l=Math.max(0,r-o);this.updateFilter(t,"offset",l),this.loadExperts(n,t,!0)}break;case"first-page":s.paginationMode==="traditional"&&(this.updateFilter(t,"offset",0),this.loadExperts(n,t,!0));break;case"last-page":if(s.paginationMode==="traditional"){let d=(Math.ceil(s.totalCount/o)-1)*o;this.updateFilter(t,"offset",d),this.loadExperts(n,t,!0)}break;case"load-more":this.loadMoreExperts(n,t).finally(()=>{i&&i instanceof HTMLButtonElement&&(i.disabled=!1)});return;case"reload":this.state.updateState(t,{cachedPages:new Map}),this.loadExperts(n,t);break}i&&i instanceof HTMLButtonElement&&e!=="load-more"&&setTimeout(()=>{i.disabled=!1},100)}async loadMoreExperts(t,e){let a=this.state.getState(e);if(a.paginationMode==="traditional"){this.log("Load more not supported in traditional pagination mode");return}let i=a.filters.limit||20,s=a.experts.length;this.log(`Loading more experts: currentOffset=${s}, limit=${i}`);try{this.state.updateState(e,{isInfiniteLoading:!0}),this.updateLoadMoreButtonState(t,e,!0);let n=await this.client.listExperts(e,{...a.filters,offset:s,limit:i});this.log(`Loaded ${n.data.length} more experts from offset ${s}`),this.handleInfinitePaginationResponse(e,t,n)}catch(n){this.log("Failed to load more experts",n),this.state.updateState(e,{isInfiniteLoading:!1}),this.updateLoadMoreButtonState(t,e,!1,"Error loading more"),setTimeout(()=>{this.updateLoadMoreButtonState(t,e,!1)},3e3)}finally{this.updateLoadMoreButtonState(t,e,!1)}}updateLoadMoreButtonState(t,e,a,i){let s=this.querySelectorAll(t,'[data-contra-action="load-more"]'),n=this.state.getState(e);s.forEach(o=>{let r=o;if(i){r.textContent=i,r.disabled=!0,r.classList.add("error");return}r.classList.remove("error"),a?(r.textContent="Loading...",r.disabled=!0,r.classList.add("loading")):(r.classList.remove("loading"),n.experts.length<n.totalCount?(r.textContent=this.config.loadMoreText,r.disabled=!1):(r.textContent="All experts loaded",r.disabled=!0,r.classList.add("disabled")))})}async loadNextPageInfinite(t,e){return this.loadMoreExperts(t,e)}updatePaginationControls(t,e){let a=this.state.getState(e),i=a.filters.limit||20,s=Math.ceil(a.totalCount/i);a.paginationMode==="traditional"?this.updateTraditionalPaginationControls(t,a,s):this.updateInfinitePaginationControls(t,a),this.log(`Pagination controls updated: mode=${a.paginationMode}, page=${a.currentPage}/${s}, hasNext=${a.hasNextPage}`)}updateTraditionalPaginationControls(t,e,a){let i=this.querySelectorAll(t,'[data-contra-action="prev-page"]'),s=this.querySelectorAll(t,'[data-contra-action="next-page"]'),n=this.querySelectorAll(t,'[data-contra-action="first-page"]'),o=this.querySelectorAll(t,'[data-contra-action="last-page"]');i.forEach(d=>{let u=d;u.disabled=!e.hasPreviousPage,u.classList.toggle("disabled",!e.hasPreviousPage)}),s.forEach(d=>{let u=d;u.disabled=!e.hasNextPage,u.classList.toggle("disabled",!e.hasNextPage)}),n.forEach(d=>{let u=d;u.disabled=e.currentPage<=1,u.classList.toggle("disabled",e.currentPage<=1)}),o.forEach(d=>{let u=d;u.disabled=e.currentPage>=a,u.classList.toggle("disabled",e.currentPage>=a)}),this.querySelectorAll(t,"[data-contra-pagination-info]").forEach(d=>{d.textContent=`Page ${e.currentPage} of ${a} (${e.totalCount} total)`});let l=t.querySelector(".pagination-section");l&&(l.style.display=a>1?"block":"none")}updateInfinitePaginationControls(t,e){this.updateLoadMoreButtonState(t,e.programId||"default",e.isInfiniteLoading),this.querySelectorAll(t,"[data-contra-pagination-info]").forEach(s=>{let n=e.experts.length,o=e.totalCount;s.textContent=`Showing ${n} of ${o} experts`});let i=t.querySelector(".pagination-controls");i&&(i.style.display="none")}updateInfiniteLoadingState(t,e){this.querySelectorAll(t,"[data-contra-infinite-loading]").forEach(i=>{i.style.display=e?"":"none"})}renderNewExperts(t,e){let a=this.querySelector(t,`[${h}${g.template}]`);if(!a){this.log("No template found for rendering new experts",t);return}let i=document.createDocumentFragment();e.forEach(s=>{let n=this.populateExpertCard(a,s);i.appendChild(n)}),t.appendChild(i),this.log(`Rendered ${e.length} new expert cards for load more`)}getAttr(t,e){return t.getAttribute(`${h}${e}`)}querySelector(t,e){return t.querySelector(e)}querySelectorAll(t,e){return Array.from(t.querySelectorAll(e))}findExpertContainers(){this.log("Looking for expert containers..."),this.log("Document ready state:",document.readyState),this.log("Total elements in document:",document.querySelectorAll("*").length);let t=["[data-contra-limit]","[data-contra-pagination]","[data-contra-template]"],e=[];for(let s of t){let n=Array.from(document.querySelectorAll(s));this.log(`Found ${n.length} elements with selector: ${s}`,n),e.push(...n)}if(e.length===0){this.log("No elements found with standard selectors, trying broader search...");let s=Array.from(document.querySelectorAll("[data-contra-limit], [data-contra-template], [data-contra-pagination]"));this.log(`Found ${s.length} elements with any contra attributes:`,s);let n=Array.from(document.querySelectorAll("div")).filter(o=>{let r=o.hasAttribute("data-contra-limit"),l=o.querySelector("[data-contra-template]"),d=o.className.includes("contra");return r||l||d});this.log(`Found ${n.length} potential container candidates:`,n),e.push(...n)}let a=new Set;for(let s of e)if(s.hasAttribute("data-contra-limit")||s.hasAttribute("data-contra-pagination"))a.add(s),this.log("Found container (has limit/pagination):",s);else if(s.hasAttribute("data-contra-template")){let n=s.parentElement;n&&(a.add(n),this.log("Found container (template parent):",n))}else s.className.includes("contra")&&s.querySelector("[data-contra-template]")&&(a.add(s),this.log("Found container (has contra class and template):",s));let i=Array.from(a);return this.log(`Total unique containers found: ${i.length}`,i),i.length===0&&(this.log("\u274C No containers found! Debugging info:"),this.log("- Document body HTML:",document.body?.innerHTML?.substring(0,500)+"..."),this.log("- All divs:",Array.from(document.querySelectorAll("div")).slice(0,10)),this.log("- Elements with data attributes:",Array.from(document.querySelectorAll("[data-contra-limit], [data-contra-template], [data-contra-pagination]")))),i}parseFiltersFromElement(t){let e={};return Object.entries({available:"available",languages:"languages",location:"location","min-rate":"minRate","max-rate":"maxRate",sort:"sortBy",limit:"limit",offset:"offset"}).forEach(([i,s])=>{let n=this.getAttr(t,i);n!=null&&(s==="available"?e[s]=n==="true":s==="languages"?e[s]=n.split(",").map(o=>o.trim()):["minRate","maxRate","limit","offset"].includes(s)?e[s]=parseInt(n):e[s]=n)}),e.offset===void 0&&(e.offset=0),e}getControlValue(t){if(t instanceof HTMLInputElement)switch(t.type){case"checkbox":return t.checked;case"number":case"range":return t.valueAsNumber;default:return t.value}else if(t instanceof HTMLSelectElement)return t.multiple?Array.from(t.selectedOptions).map(e=>e.value):t.value;return null}updateFilter(t,e,a,i="replace"){let n={...this.state.getState(t).filters},o=a;if(e==="available"?typeof a=="string"&&(a==="true"?o=!0:a==="false"?o=!1:(a===""||a===null)&&(o=void 0)):(e==="minRate"||e==="maxRate")&&(a===""||a===null?o=void 0:o=Number(a)),i==="append"&&Array.isArray(n[e])){let l=n[e];n[e]=[...l,o]}else n[e]=o;e!=="offset"&&(n.offset=0),this.state.updateState(t,{filters:n}),this.log(`Filter updated: ${e} = ${o} (original: ${a})`);let r={filters:n,element:document.querySelector(`[data-container-id="${t}"]`)};this.dispatchEvent(document,"filterChange",r)}showLoading(t,e){let a=this.querySelector(t,`[${h}${g.loading}]`);a&&(a.style.display=e?"":"none"),t.classList.toggle(this.config.loadingClass,e)}showError(t,e){let a=this.querySelector(t,`[${h}${g.error}]`);a&&(a.textContent=e.message,a.style.display=""),t.classList.add(this.config.errorClass),this.log("Error displayed",e)}dispatchEvent(t,e,a){let i=new CustomEvent(`contra:${e}`,{detail:a});t.dispatchEvent(i)}log(t,...e){this.config.debug&&console.log(`[ContraWebflow] ${t}`,...e)}};function y(){let c=document.getElementById("contra-config");if(!c){console.warn("[ContraWebflow] No config element found. Runtime not initialized.");return}try{let t=JSON.parse(c.textContent||"{}");if(!t.apiKey){console.error("[ContraWebflow] API key is required in config.");return}if(!t.program){console.error("[ContraWebflow] Program ID is required in config.");return}setTimeout(()=>{let a=new m(t);window.contraRuntime=a,a.init().catch(i=>{console.error("[ContraWebflow] Runtime initialization failed:",i)})},100)}catch(t){console.error("[ContraWebflow] Failed to parse config:",t)}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",y):document.readyState==="interactive"?setTimeout(y,50):y();return T(A);})();
//# sourceMappingURL=runtime.min.js.map
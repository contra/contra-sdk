'use strict';var client=require('@contra/client');var f="data-contra-",d={template:"template",loading:"loading",error:"error",empty:"empty",field:"field",format:"format",repeat:"repeat",max:"max",filter:"filter",filterType:"filter-type",showWhen:"show-when",hideWhen:"hide-when",action:"action",target:"target"},E=class{constructor(){this.states=new Map;}getState(e){return this.states.has(e)||this.states.set(e,{filters:{},experts:[],loading:false,error:null,currentPage:1,totalCount:0,cachedPages:new Map,loadingPages:new Set,hasNextPage:false,hasPreviousPage:false,isInfiniteLoading:false,lastScrollPosition:0,paginationMode:"traditional"}),this.states.get(e)}updateState(e,t){let i=this.getState(e);Object.assign(i,t),this.states.set(e,i);}cachePage(e,t,i){let a=this.getState(e);if(a.cachedPages.set(t,i),a.cachedPages.size>5){let s=Math.min(...a.cachedPages.keys());a.cachedPages.delete(s);}}getCachedPage(e,t){return this.getState(e).cachedPages.get(t)||null}setPageLoading(e,t,i){let a=this.getState(e);i?a.loadingPages.add(t):a.loadingPages.delete(t);}isPageLoading(e,t){return this.getState(e).loadingPages.has(t)}},h=class{constructor(e){this.state=new E;this.debouncedReload=new Map;this.config={debug:false,program:"",loadingClass:"loading",errorClass:"error",emptyClass:"empty",autoReload:true,debounceDelay:300,maxRetries:3,paginationMode:"traditional",infiniteScrollThreshold:500,preloadNextPage:true,maxCachedPages:5,smoothScrollBehavior:"auto",loadMoreText:"Load More",videoAutoplay:false,videoHoverPlay:true,videoMuted:true,videoLoop:true,videoControls:false,...e},this.client=new client.ContraClient({apiKey:this.config.apiKey,debug:this.config.debug}),this.log("Runtime initialized",this.config);}async init(){this.log("Initializing runtime...");try{let e=this.findExpertContainers(),t=e.filter(i=>!i.hasAttribute("data-contra-initialized"));this.log(`Found ${t.length} uninitialised expert containers (${e.length} total)`);for(let i of t)await this.initContainer(i);this.log("Runtime initialization complete");}catch(e){throw this.log("Runtime initialization failed",e),e}}async initContainer(e){let t=this.config.program;if(!t){this.log("No program ID found in config",e);return}this.log(`Initializing container for program: ${t}`);try{this.setupContainer(e,t),this.wireFilterControls(e,t),this.wireActionButtons(e,t),await this.loadExperts(e,t);}catch(i){this.log(`Failed to initialize container for program ${t}`,i),this.showError(e,i);}}setupContainer(e,t){let i=e;i.classList.add("contra-runtime"),i.setAttribute("data-contra-initialized","true"),i.setAttribute("data-program-id",t);let a=this.parseFiltersFromElement(e),s=this.determinePaginationMode(e);this.state.updateState(t,{filters:a,paginationMode:s}),this.setupPagination(e,t,s);let n=client.utils.debounce(()=>{this.loadExperts(e,t);},this.config.debounceDelay);this.debouncedReload.set(t,n),this.log(`Container setup complete for program: ${t}`,{initialFilters:a,paginationMode:s});}determinePaginationMode(e){return this.getAttr(e,"pagination-mode")||this.config.paginationMode}setupPagination(e,t,i){this.log(`Setting up ${i} pagination for program: ${t}`),(i==="infinite"||i==="hybrid")&&this.setupInfiniteScroll(e,t),(i==="traditional"||i==="hybrid")&&this.setupTraditionalPagination(e,t),(i==="infinite"||i==="hybrid")&&this.setupLoadMoreButton(e,t);}setupInfiniteScroll(e,t){let i=false,a=client.utils.throttle(()=>{if(i)return;let s=this.state.getState(t);if(s.isInfiniteLoading||!s.hasNextPage)return;let n=window.scrollY+window.innerHeight,o=document.documentElement.scrollHeight,r=this.config.infiniteScrollThreshold;n>=o-r&&(i=true,this.loadNextPageInfinite(e,t).finally(()=>{i=false;}));},100);window.addEventListener("scroll",a),e.__infiniteScrollCleanup=()=>{window.removeEventListener("scroll",a);};}setupTraditionalPagination(e,t){this.updatePaginationControls(e,t);}setupLoadMoreButton(e,t){this.querySelectorAll(e,'[data-contra-action="load-more"]').forEach(a=>{a.textContent?.trim()||(a.textContent=this.config.loadMoreText);});}wireFilterControls(e,t){let i=this.querySelectorAll(e,`[${f}${d.filter}]`);this.log(`Found ${i.length} filter controls for program: ${t}`),i.forEach(a=>{let s=this.getAttr(a,d.filter),n=this.getAttr(a,d.filterType)||"replace";if(s){if(a instanceof HTMLInputElement){let o=a.type==="range"||a.type==="number"?"input":"change";a.addEventListener(o,()=>{this.updateFilter(t,s,this.getControlValue(a),n),this.config.autoReload&&this.debouncedReload.get(t)?.();});}else a instanceof HTMLSelectElement&&a.addEventListener("change",()=>{this.updateFilter(t,s,this.getControlValue(a),n),this.config.autoReload&&this.debouncedReload.get(t)?.();});this.log(`Wired filter control: ${s} (${n})`,a);}});}wireActionButtons(e,t){this.querySelectorAll(e,`[${f}${d.action}]`).forEach(a=>{let s=this.getAttr(a,d.action),n=this.getAttr(a,d.target);s&&a.addEventListener("click",o=>{o.preventDefault(),this.handleAction(t,s,n,a);});});}async loadExperts(e,t,i=false){let a=this.state.getState(t);this.log(`Loading experts for program: ${t}`,a.filters);try{this.showLoading(e,!0),this.state.updateState(t,{loading:!0,error:null});let s=Math.floor((a.filters.offset||0)/(a.filters.limit||20))+1;if(i&&a.paginationMode==="traditional"){let p=this.state.getCachedPage(t,s);if(p){this.log(`Using cached page ${s}`),this.renderExperts(e,p),this.state.updateState(t,{experts:p,currentPage:s,loading:!1}),this.updatePaginationControls(e,t),this.showLoading(e,!1);return}}let n=await this.client.listExperts(t,a.filters);this.log(`Loaded ${n.data.length} experts`,n);let o=a.filters.limit||20,r=a.filters.offset||0,l=Math.floor(r/o)+1,c=Math.ceil(n.totalCount/o),u=r+n.data.length<n.totalCount,y=l>1;this.state.updateState(t,{experts:n.data,totalCount:n.totalCount,currentPage:l,hasNextPage:u,hasPreviousPage:y,loading:!1}),this.state.cachePage(t,l,n.data),this.renderExperts(e,n.data),this.updateUIStates(e,t),this.updatePaginationControls(e,t),this.dispatchEvent(e,"expertsLoaded",{experts:n.data,totalCount:n.totalCount,filters:a.filters,page:l,totalPages:c,hasNextPage:u,hasPreviousPage:y});}catch(s){this.log(`Failed to load experts for program: ${t}`,s),this.state.updateState(t,{loading:false,error:s}),this.showError(e,s),this.dispatchEvent(e,"expertsError",{error:s,context:`Loading experts for program ${t}`});}finally{this.showLoading(e,false);}}renderExperts(e,t){let i=this.querySelector(e,`[${f}${d.template}]`);if(!i){this.log("No template found in container",e);return}this.querySelectorAll(e,":scope > *:not([data-contra-template]):not([data-contra-loading]):not([data-contra-error]):not([data-contra-empty])").forEach(s=>s.remove()),t.forEach(s=>{let n=this.populateExpertCard(i,s);e.appendChild(n);}),this.log(`Rendered ${t.length} expert cards`);}populateExpertCard(e,t){let i=e.cloneNode(true);return i.removeAttribute(`${f}${d.template}`),i.style.display="",this.populateFields(i,t),this.populateRepeatingElements(i,t),this.handleConditionalDisplay(i,t),i}populateFields(e,t){this.querySelectorAll(e,`[${f}${d.field}]`).forEach(s=>{let n=this.getAttr(s,d.field),o=this.getAttr(s,d.format);if(!n||!(n in t))return;let r=t[n];this.setElementValue(s,r,o);}),this.querySelectorAll(e,"[data-contra-stars]").forEach(s=>{t.averageReviewScore&&this.renderStarRating(s,t.averageReviewScore);});}setElementValue(e,t,i){if(!(t==null||t==="")){if(this.isMediaField(e)&&typeof t=="string"&&t.trim()){this.setMediaValue(e,t);return}if(e instanceof HTMLAnchorElement)e.href=String(t),e.textContent?.trim()||(e.textContent=String(t));else if(e instanceof HTMLInputElement)e.value=String(t);else if(e instanceof HTMLImageElement)e.src=String(t),e.alt=e.alt||"Image";else {let a=String(t);if(i)switch(i){case "currency":a=typeof t=="number"?`$${t}`:a;break;case "rate":a=client.utils.formatRate(typeof t=="number"?t:null);break;case "rating":a=typeof t=="number"?t.toFixed(1):a;break;case "earnings":typeof t=="number"&&(t>=1e6?a=`$${Math.floor(t/1e6)}M+`:t>=1e3?a=`$${Math.floor(t/1e3)}k+`:a=`$${t}`);break;case "number":a=typeof t=="number"?t.toLocaleString():a;break;case "truncate":a=a.length>100?a.substring(0,97)+"...":a;break;case "boolean":a=t?"Yes":"No";break;case "availability":a=t?"Available":"Not Available";break}e.textContent=a;}}}renderStarRating(e,t){let i=Math.floor(t),a=t%1>=.5,s=5-i-(a?1:0),n="";for(let r=0;r<i;r++)n+='<span class="contra-star contra-star-full">\u2605</span>';a&&(n+='<span class="contra-star contra-star-half">\u2605</span>');for(let r=0;r<s;r++)n+='<span class="contra-star contra-star-empty">\u2606</span>';e.innerHTML=n;let o=e.closest("[data-contra-template]")||e.closest(".expert-card");o&&this.querySelectorAll(o,"[data-contra-rating-text]").forEach(l=>{l.textContent=t.toFixed(1);});}isMediaField(e){return this.getAttr(e,d.field)==="coverUrl"}setMediaValue(e,t){let i=this.detectMediaType(t),a=e.parentElement;if(!a){this.log("Media element has no parent for replacement",e);return}e.remove();let s;switch(i){case "video":s=this.createVideoElement(t,e);break;case "image":default:s=this.createImageElement(t,e);break}this.transferAttributes(e,s),a.appendChild(s),this.log(`Created ${i} element for URL: ${t}`);}detectMediaType(e){if(!e||typeof e!="string")return this.log("Invalid URL provided to detectMediaType:",e),"image";let t=e.toLowerCase(),a=[".mp4",".webm",".mov",".avi",".mkv",".ogg"].some(n=>t.includes(n)),s=t.includes("cloudinary.com/")&&t.includes("/video/");return a||s?"video":"image"}createVideoElement(e,t){let i=document.createElement("video");return i.src=e,i.muted=this.config.videoMuted,i.loop=this.config.videoLoop,i.playsInline=true,i.preload="metadata",i.controls=this.config.videoControls,i.style.width="100%",i.style.height="100%",i.style.objectFit="cover",i.style.borderRadius="inherit",this.config.videoAutoplay&&(i.autoplay=true,i.setAttribute("autoplay","")),i.onerror=()=>{this.log(`Video failed to load: ${e}`);let a=this.extractVideoThumbnail(e);if(a){let s=this.createImageElement(a,t);i.parentElement?.replaceChild(s,i);}else i.style.background="#f3f4f6",i.style.position="relative",i.innerHTML='<div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#9ca3af;font-size:12px;">Video unavailable</div>';},this.config.videoHoverPlay&&!this.config.videoAutoplay&&(i.addEventListener("mouseenter",()=>{i.currentTime=0,i.play().catch(()=>{});}),i.addEventListener("mouseleave",()=>{i.pause(),i.currentTime=0;})),i}createImageElement(e,t){let i=document.createElement("img");return i.src=e,i.alt=t.getAttribute("alt")||"Media content",i.loading="lazy",i.style.width="100%",i.style.height="100%",i.style.objectFit="cover",i.style.borderRadius="inherit",i.onerror=()=>{this.log(`Image failed to load: ${e}`),i.style.background="#f3f4f6",i.style.opacity="0.5",i.alt="Image unavailable",i.style.position="relative";let a=document.createElement("div");a.style.cssText=`
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: #9ca3af;
        font-size: 12px;
        text-align: center;
      `,a.textContent="\u{1F5BC}\uFE0F Image unavailable",i.parentElement?.appendChild(a);},i}extractVideoThumbnail(e){return e.includes("cloudinary.com/")&&e.includes("/video/")?e.replace("/video/","/image/").replace(/\.(mp4|webm|mov|avi|mkv)$/i,".jpg").replace("fl_progressive","f_auto,q_auto,c_fill"):null}transferAttributes(e,t){if(e.className&&(t.className=e.className),Array.from(e.attributes).forEach(i=>{i.name.startsWith("data-")&&i.name!==`${f}${d.field}`&&t.setAttribute(i.name,i.value);}),e.getAttribute("style")){let i=t.getAttribute("style")||"";t.setAttribute("style",i+"; "+e.getAttribute("style"));}}populateRepeatingElements(e,t){this.querySelectorAll(e,`[${f}${d.repeat}]`).forEach(a=>{let s=this.getAttr(a,d.repeat),n=parseInt(this.getAttr(a,d.max)||"10");s==="projects"&&t.projects?this.populateRepeatingContainer(a,t.projects.slice(0,n)):s==="socialLinks"&&t.socialLinks?this.populateRepeatingContainer(a,t.socialLinks.slice(0,n)):s==="skillTags"&&t.skillTags&&this.populateRepeatingContainer(a,t.skillTags.slice(0,n).map(o=>({name:o})));});}populateRepeatingContainer(e,t){let i=e.firstElementChild;i&&(e.innerHTML="",t.forEach(a=>{let s=i.cloneNode(true);this.populateFields(s,a),e.appendChild(s);}),t.length===0&&(e.style.display="none"));}handleConditionalDisplay(e,t){this.querySelectorAll(e,`[${f}${d.showWhen}], [${f}${d.hideWhen}]`).forEach(a=>{let s=this.getAttr(a,d.showWhen),n=this.getAttr(a,d.hideWhen),o=true;s&&(o=this.evaluateCondition(t,s)),n&&(o=o&&!this.evaluateCondition(t,n)),a.style.display=o?"":"none";});}evaluateCondition(e,t){if(!t||typeof t!="string")return this.log("Invalid condition provided:",t),false;let i=t.split(":");if(i.length<2)return this.log("Invalid condition format:",t),false;let a=i[0],s=i.slice(1).join(":"),n=e[a];if(this.log(`Evaluating condition: ${a} (${n}, type: ${typeof n}) against ${s}`),n==null)return this.log(`Field '${a}' is null/undefined, condition fails`),false;if(s.startsWith(">=")){let o=s.substring(2),r=Number(n)>=Number(o);return this.log(`Comparison: ${n} >= ${o} = ${r}`),r}else if(s.startsWith("<=")){let o=s.substring(2),r=Number(n)<=Number(o);return this.log(`Comparison: ${n} <= ${o} = ${r}`),r}else if(s.startsWith(">")){let o=s.substring(1),r=Number(n)>Number(o);return this.log(`Comparison: ${n} > ${o} = ${r}`),r}else if(s.startsWith("<")){let o=s.substring(1),r=Number(n)<Number(o);return this.log(`Comparison: ${n} < ${o} = ${r}`),r}else {let o=false;if(typeof n=="boolean")s.toLowerCase()==="true"?o=n===true:s.toLowerCase()==="false"?o=n===false:o=false,this.log(`Boolean comparison: ${n} === ${s.toLowerCase()==="true"} = ${o}`);else if(typeof n=="number"){let r=Number(s);o=!isNaN(r)&&n===r,this.log(`Number comparison: ${n} === ${r} = ${o}`);}else {let r=String(n),l=String(s);o=r.toLowerCase()===l.toLowerCase(),this.log(`String comparison: '${r}' === '${l}' = ${o}`);}return o}}updateUIStates(e,t){let i=this.state.getState(t),a=this.querySelector(e,`[${f}${d.empty}]`);a&&(a.style.display=i.experts.length===0?"":"none"),this.querySelectorAll(e,"[data-contra-pagination-info]").forEach(o=>{let{currentPage:r,totalCount:l}=i,c=i.filters.limit||20,u=Math.ceil(l/c);o.textContent=`Page ${r} of ${u} (${l} total)`;}),this.querySelectorAll(e,"[data-contra-filter-summary]").forEach(o=>{let r=Object.entries(i.filters).filter(([l,c])=>c!=null&&c!=="").map(([l,c])=>`${l}: ${c}`).join(", ");o.textContent=r||"No filters applied";});}handleAction(e,t,i,a){let s=this.state.getState(e),n=document.querySelector(`[data-program-id="${e}"]`);if(!n){this.log(`Container not found for program: ${e}`);return}if(a&&a instanceof HTMLButtonElement){a.textContent;a.disabled=true;}switch(t){case "next-page":let o=s.filters.limit||20,r=(s.filters.offset||0)+o;r<s.totalCount&&(this.updateFilter(e,"offset",r),setTimeout(()=>{this.loadExperts(n,e,true);},0));break;case "prev-page":let l=Math.max(0,(s.filters.offset||0)-(s.filters.limit||20));this.updateFilter(e,"offset",l),setTimeout(()=>{this.loadExperts(n,e,true);},0);break;case "load-more":this.loadMoreExperts(n,e).finally(()=>{a&&a instanceof HTMLButtonElement&&(a.disabled=false);});return;case "first-page":this.updateFilter(e,"offset",0),setTimeout(()=>{this.loadExperts(n,e,true);},0);break;case "last-page":let c=Math.max(0,Math.floor((s.totalCount-1)/(s.filters.limit||20))*(s.filters.limit||20));this.updateFilter(e,"offset",c),setTimeout(()=>{this.loadExperts(n,e,true);},0);break;case "clear-filters":this.state.updateState(e,{filters:{limit:s.filters.limit},currentPage:1,cachedPages:new Map}),this.config.autoReload&&this.debouncedReload.get(e)?.();break;case "reload":this.state.updateState(e,{cachedPages:new Map}),this.client.clearCache(`experts:${e}`),this.config.autoReload&&this.debouncedReload.get(e)?.();break}a&&a instanceof HTMLButtonElement&&t!=="load-more"&&setTimeout(()=>{a.disabled=false;},100);}async loadMoreExperts(e,t){let i=this.state.getState(t),a=i.filters.limit||20,s=i.filters.offset||0,n=s+a;this.log(`Loading more experts: current offset=${s}, next offset=${n}, limit=${a}`);try{this.state.updateState(t,{isInfiniteLoading:!0}),this.updateLoadMoreButtonState(e,t,!0);let o=await this.client.listExperts(t,{...i.filters,offset:n,limit:a});this.log(`Loaded ${o.data.length} more experts from offset ${n}`);let r={...i.filters,offset:n},l=[...i.experts,...o.data],c=Math.floor(n/a)+1;this.state.updateState(t,{experts:l,filters:r,currentPage:c,totalCount:o.totalCount,hasNextPage:l.length<o.totalCount,isInfiniteLoading:!1}),this.state.cachePage(t,c,o.data),this.renderNewExperts(e,o.data),this.updatePaginationControls(e,t),this.dispatchEvent(e,"expertsLoaded",{experts:o.data,totalExperts:l,totalCount:o.totalCount,page:c,isLoadMore:!0});}catch(o){this.log("Failed to load more experts",o),this.state.updateState(t,{isInfiniteLoading:false}),this.updateLoadMoreButtonState(e,t,false,"Error loading more"),setTimeout(()=>{this.updateLoadMoreButtonState(e,t,false);},3e3);}finally{this.updateLoadMoreButtonState(e,t,false);}}updateLoadMoreButtonState(e,t,i,a){let s=this.querySelectorAll(e,'[data-contra-action="load-more"]'),n=this.state.getState(t);s.forEach(o=>{let r=o;if(a){r.textContent=a,r.disabled=true,r.classList.add("error");return}r.classList.remove("error"),i?(r.textContent="Loading...",r.disabled=true,r.classList.add("loading")):(r.classList.remove("loading"),n.experts.length<n.totalCount?(r.textContent=this.config.loadMoreText,r.disabled=false):(r.textContent="All experts loaded",r.disabled=true,r.classList.add("disabled")));});}async loadNextPageInfinite(e,t){return this.loadMoreExperts(e,t)}updatePaginationControls(e,t){let i=this.state.getState(t),a=i.filters.limit||20,s=Math.ceil(i.totalCount/a),n=this.querySelectorAll(e,'[data-contra-action="prev-page"]'),o=this.querySelectorAll(e,'[data-contra-action="next-page"]');n.forEach(l=>{let c=l;c.disabled=i.currentPage<=1,c.classList.toggle("disabled",i.currentPage<=1);}),o.forEach(l=>{let c=l;c.disabled=i.currentPage>=s,c.classList.toggle("disabled",i.currentPage>=s);}),this.updateLoadMoreButtonState(e,t,i.isInfiniteLoading),this.querySelectorAll(e,"[data-contra-pagination-info]").forEach(l=>{let c=i.experts.length,u=i.totalCount;i.paginationMode==="infinite"||i.paginationMode==="hybrid"?l.textContent=`Showing ${c} of ${u} experts`:l.textContent=`Page ${i.currentPage} of ${s} (${u} total)`;}),this.log(`Pagination controls updated: loaded ${i.experts.length}/${i.totalCount}, hasNext: ${i.hasNextPage}`);}updateInfiniteLoadingState(e,t){this.querySelectorAll(e,"[data-contra-infinite-loading]").forEach(a=>{a.style.display=t?"":"none";});}renderNewExperts(e,t){let i=this.querySelector(e,`[${f}${d.template}]`);if(!i){this.log("No template found for rendering new experts",e);return}let a=document.createDocumentFragment();t.forEach(s=>{let n=this.populateExpertCard(i,s);a.appendChild(n);}),e.appendChild(a),this.log(`Rendered ${t.length} new expert cards for load more`);}getAttr(e,t){return e.getAttribute(`${f}${t}`)}querySelector(e,t){return e.querySelector(t)}querySelectorAll(e,t){return Array.from(e.querySelectorAll(t))}findExpertContainers(){let e=Array.from(document.querySelectorAll(`[${f}template], [${f}limit], [${f}pagination-mode]`)).map(t=>t.closest("div, section, article")||t.parentElement).filter((t,i,a)=>t&&a.indexOf(t)===i).filter(t=>t);return e.length===0?Array.from(document.querySelectorAll(`[${f}template]`)).map(i=>i.parentElement).filter(i=>i):e}parseFiltersFromElement(e){let t={};return Object.entries({available:"available",languages:"languages",location:"location","min-rate":"minRate","max-rate":"maxRate",sort:"sortBy",limit:"limit",offset:"offset"}).forEach(([a,s])=>{let n=this.getAttr(e,a);n!=null&&(s==="available"?t[s]=n==="true":s==="languages"?t[s]=n.split(",").map(o=>o.trim()):["minRate","maxRate","limit","offset"].includes(s)?t[s]=parseInt(n):t[s]=n);}),t.offset===void 0&&(t.offset=0),t}getControlValue(e){if(e instanceof HTMLInputElement)switch(e.type){case "checkbox":return e.checked;case "number":case "range":return e.valueAsNumber;default:return e.value}else if(e instanceof HTMLSelectElement)return e.multiple?Array.from(e.selectedOptions).map(t=>t.value):e.value;return null}updateFilter(e,t,i,a="replace"){let n={...this.state.getState(e).filters},o=i;if(t==="available"?typeof i=="string"&&(i==="true"?o=true:i==="false"?o=false:(i===""||i===null)&&(o=void 0)):(t==="minRate"||t==="maxRate")&&(i===""||i===null?o=void 0:o=Number(i)),a==="append"&&Array.isArray(n[t])){let l=n[t];n[t]=[...l,o];}else n[t]=o;t!=="offset"&&(n.offset=0),this.state.updateState(e,{filters:n}),this.log(`Filter updated: ${t} = ${o} (original: ${i})`);let r={filters:n,element:document.querySelector(`[data-program-id="${e}"]`)};this.dispatchEvent(document,"filterChange",r);}showLoading(e,t){let i=this.querySelector(e,`[${f}${d.loading}]`);i&&(i.style.display=t?"":"none"),e.classList.toggle(this.config.loadingClass,t);}showError(e,t){let i=this.querySelector(e,`[${f}${d.error}]`);i&&(i.textContent=t.message,i.style.display=""),e.classList.add(this.config.errorClass),this.log("Error displayed",t);}dispatchEvent(e,t,i){let a=new CustomEvent(`contra:${t}`,{detail:i});e.dispatchEvent(a);}log(e,...t){this.config.debug&&console.log(`[ContraWebflow] ${e}`,...t);}};function v(){let g=document.getElementById("contra-config");if(!g){console.warn("[ContraWebflow] No config element found. Runtime not initialized.");return}try{let e=JSON.parse(g.textContent||"{}");if(!e.apiKey){console.error("[ContraWebflow] API key is required in config.");return}if(!e.program){console.error("[ContraWebflow] Program ID is required in config.");return}let t=new h(e);window.contraRuntime=t,t.init().catch(i=>{console.error("[ContraWebflow] Runtime initialization failed:",i);});}catch(e){console.error("[ContraWebflow] Failed to parse config:",e);}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",v):v();exports.ContraWebflowRuntime=h;//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map
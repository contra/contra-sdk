<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pagination Fix Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .expert-card { border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 8px; }
        .pagination-section { margin-top: 30px; padding: 20px; border-top: 2px solid #eee; }
        .pagination-btn { padding: 8px 16px; margin: 0 5px; border: 1px solid #ddd; background: white; cursor: pointer; }
        .pagination-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .pagination-btn.active { background: #007cba; color: white; }
        .loading { opacity: 0.6; }
        [data-contra-template] { display: none; }
    </style>
</head>
<body>
    <h1>üß™ Pagination Fix Test</h1>
    <p>Testing pagination with limit=2 to ensure pagination shows correctly</p>

    <!-- Configuration Script -->
    <script id="contra-config" type="application/json">
    {
        "program": "kajabi_expert",
        "apiKey": "contra_4548fabb.24cecae57234e341de12a33526f35655864e5af1f9ad04d156e65d18dea1bc4a",
        "debug": true,
        "paginationMode": "traditional"
    }
    </script>

    <!-- Expert Container -->
    <div data-contra-limit="2" data-contra-offset="0" data-contra-pagination-mode="traditional">
        
        <!-- Expert Template -->
        <div data-contra-template class="expert-card">
            <h3 data-contra-field="name">Expert Name</h3>
            <p data-contra-field="oneLiner">Expert description</p>
            <p><strong>Location:</strong> <span data-contra-field="location">Location</span></p>
            <p><strong>Rate:</strong> <span data-contra-field="hourlyRateUSD" data-contra-format="rate">$0/hr</span></p>
        </div>
        
        <!-- Loading State -->
        <div data-contra-loading style="display: none;">
            <p>‚è≥ Loading experts...</p>
        </div>
        
        <!-- Error State -->
        <div data-contra-error style="display: none;">
            <p>‚ùå Error loading experts</p>
        </div>
        
        <!-- Empty State -->
        <div data-contra-empty style="display: none;">
            <p>üîç No experts found</p>
        </div>
    </div>
    
    <!-- Pagination Section -->
    <div class="pagination-section">
        <div data-contra-pagination-info>Loading pagination info...</div>
        <div style="margin-top: 15px;">
            <button data-contra-action="prev-page" class="pagination-btn">‚Üê Previous</button>
            <button class="pagination-btn active">1</button>
            <button data-contra-action="next-page" class="pagination-btn">Next ‚Üí</button>
        </div>
    </div>

    <!-- Load Fixed Runtime -->
    <script src="https://cdn.jsdelivr.net/gh/javron/contra-sdk@latest/packages/contra-webflow/dist/runtime.min.js?v=1.2.0"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üß™ Pagination test initialized');
            
            document.addEventListener('contra:expertsLoaded', (event) => {
                const { experts, totalCount, page, totalPages, hasNextPage, hasPreviousPage } = event.detail;
                console.log('üìä Pagination Test Results:', {
                    expertsLoaded: experts?.length,
                    totalCount,
                    currentPage: page,
                    totalPages,
                    hasNextPage,
                    hasPreviousPage
                });
                
                // Update test results
                const info = document.querySelector('[data-contra-pagination-info]');
                if (info) {
                    info.innerHTML = `
                        <strong>Test Results:</strong><br>
                        Experts: ${experts?.length || 0} loaded<br>
                        Total: ${totalCount}<br>
                        Page: ${page} of ${totalPages}<br>
                        Has Next: ${hasNextPage ? '‚úÖ' : '‚ùå'}<br>
                        Has Previous: ${hasPreviousPage ? '‚úÖ' : '‚ùå'}
                    `;
                }
                
                // Test pagination visibility logic
                const paginationSection = document.querySelector('.pagination-section');
                if (totalPages <= 1) {
                    console.log('üîç Pagination should be hidden (totalPages <= 1)');
                    paginationSection.style.background = '#ffebee';
                    paginationSection.innerHTML += '<p style="color: red; margin-top: 10px;">‚ö†Ô∏è Pagination should be hidden for single page</p>';
                } else {
                    console.log('‚úÖ Pagination should be visible (totalPages > 1)');
                    paginationSection.style.background = '#e8f5e8';
                    paginationSection.innerHTML += '<p style="color: green; margin-top: 10px;">‚úÖ Pagination correctly visible for multiple pages</p>';
                }
            });
        });
    </script>
</body>
</html> 
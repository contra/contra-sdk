var c=class c{constructor(t){this.cache=new Map;this.pendingRequests=new Map;this.config={baseUrl:"https://api.contra.com",timeout:1e4,debug:false,...t},this.config.debug&&console.log("[ContraClient] Initialized with config:",this.config);}async fetch(t,e={},s=3){let r=`${this.config.baseUrl}${t}`,i=new AbortController,a=setTimeout(()=>i.abort(),this.config.timeout),p={...e,signal:i.signal,headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`,...e.headers}};try{this.config.debug&&console.log(`[ContraClient] Fetching: ${r}`,p);let n=await fetch(r,p);if(clearTimeout(a),!n.ok){let l;try{l=await n.json();}catch{l={code:`HTTP_${n.status}`,message:n.statusText||"Unknown error"};}if((n.status>=500||n.status===429)&&s>0){let f=Math.pow(2,3-s)*1e3;return await new Promise(m=>setTimeout(m,f)),this.fetch(t,e,s-1)}throw new h(l.message,l.code,n.status)}let g=await n.json();return this.config.debug&&console.log("[ContraClient] Response:",g),g}catch(n){if(clearTimeout(a),n instanceof h)throw n;if(n instanceof Error&&n.name==="AbortError")throw new h(`Request timeout after ${this.config.timeout}ms`,"TIMEOUT");if(s>0){let g=Math.pow(2,3-s)*1e3;return await new Promise(l=>setTimeout(l,g)),this.fetch(t,e,s-1)}throw new h(n instanceof Error?n.message:"Unknown error","NETWORK_ERROR")}}async fetchWithCache(t,e,s,r){let i=this.cache.get(t);if(i&&Date.now()-i.timestamp<i.ttl)return this.config.debug&&console.log(`[ContraClient] Cache hit: ${t}`),i.data;let a=`${e}${JSON.stringify(r)}`;if(this.pendingRequests.has(a))return this.config.debug&&console.log(`[ContraClient] Request deduplication: ${a}`),this.pendingRequests.get(a);let p=this.fetch(e,r);this.pendingRequests.set(a,p);try{let n=await p;return this.cache.set(t,{data:n,timestamp:Date.now(),ttl:s}),n}finally{this.pendingRequests.delete(a);}}buildQueryString(t){let e=new URLSearchParams;Object.entries(t).forEach(([r,i])=>{i!=null&&i!==""&&(Array.isArray(i)?e.set(r,i.join(",")):e.set(r,String(i)));});let s=e.toString();return s?`?${s}`:""}async getProgram(t){let e=`program:${t}`,s=`/public-api/programs/${t}`;return (await this.fetchWithCache(e,s,c.CACHE_TTL.program)).data}async listExperts(t,e={}){let s=this.buildQueryString(e),r=`experts:${t}:${JSON.stringify(e)}`,i=`/public-api/programs/${t}/experts${s}`;return this.fetchWithCache(r,i,c.CACHE_TTL.experts)}async getExpert(t){let e=`expert:${t}`,s=`/public-api/experts/${t}`;return (await this.fetchWithCache(e,s,c.CACHE_TTL.expert)).data}async searchExperts(t,e,s={}){let r={...s,q:e};return this.listExperts(t,r)}async getFilterOptions(t){let e=`filters:${t}`,s=`/public-api/programs/${t}/filters`;return (await this.fetchWithCache(e,s,c.CACHE_TTL.filters)).data}clearCache(t){if(t)for(let e of this.cache.keys())e.includes(t)&&this.cache.delete(e);else this.cache.clear();this.config.debug&&console.log(`[ContraClient] Cache cleared${t?` (pattern: ${t})`:""}`);}getCacheStats(){let t=Date.now(),e=Array.from(this.cache.entries()).map(([s,r])=>({key:s,age:t-r.timestamp,ttl:r.ttl}));return {size:this.cache.size,entries:e}}};c.CACHE_TTL={experts:5*60*1e3,expert:10*60*1e3,program:30*60*1e3,filters:60*60*1e3};var u=c,h=class extends Error{constructor(e,s,r){super(e);this.code=s;this.status=r;this.name="ContraAPIError";}},d={formatRate(o){return o?`$${o}/hr`:"Rate on request"},renderStars(o){let t=Math.floor(o),e=o%1>=.5,s=5-t-(e?1:0),r="";for(let i=0;i<t;i++)r+=`<svg class="star star-full" width="16" height="16" viewBox="0 0 24 24" fill="#FFD700">
        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
      </svg>`;e&&(r+=`<svg class="star star-half" width="16" height="16" viewBox="0 0 24 24">
        <defs>
          <linearGradient id="half-${o}">
            <stop offset="50%" stop-color="#FFD700"/>
            <stop offset="50%" stop-color="#E5E5E5"/>
          </linearGradient>
        </defs>
        <path fill="url(#half-${o})" d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
      </svg>`);for(let i=0;i<s;i++)r+=`<svg class="star star-empty" width="16" height="16" viewBox="0 0 24 24" fill="#E5E5E5">
        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
      </svg>`;return r},debounce(o,t){let e;return (...s)=>{clearTimeout(e),e=setTimeout(()=>o(...s),t);}},throttle(o,t){let e;return (...s)=>{e||(o(...s),e=true,setTimeout(()=>e=false,t));}}};export{h as ContraAPIError,u as ContraClient,d as utils};//# sourceMappingURL=index.mjs.map
//# sourceMappingURL=index.mjs.map
{"version":3,"sources":["../../contra-core/src/utils.ts","../../contra-core/src/client.ts","../src/index.ts"],"sourcesContent":["/**\n * Generate star rating SVG based on score (0-5)\n */\nexport function starSVG(score: number): string {\n  const fullStars = Math.floor(score);\n  const hasHalfStar = score % 1 >= 0.5;\n  const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);\n\n  let html = '';\n  \n  // Full stars\n  for (let i = 0; i < fullStars; i++) {\n    html += `<svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"#FFD700\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path d=\"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z\"/>\n    </svg>`;\n  }\n  \n  // Half star\n  if (hasHalfStar) {\n    html += `<svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"url(#half)\" xmlns=\"http://www.w3.org/2000/svg\">\n      <defs>\n        <linearGradient id=\"half\">\n          <stop offset=\"50%\" stop-color=\"#FFD700\"/>\n          <stop offset=\"50%\" stop-color=\"#E5E5E5\"/>\n        </linearGradient>\n      </defs>\n      <path d=\"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z\"/>\n    </svg>`;\n  }\n  \n  // Empty stars\n  for (let i = 0; i < emptyStars; i++) {\n    html += `<svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"#E5E5E5\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path d=\"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z\"/>\n    </svg>`;\n  }\n  \n  return html;\n}\n\n/**\n * Build query string from object\n */\nexport function buildQueryString(params: Record<string, any>): string {\n  const filtered = Object.entries(params)\n    .filter(([_, value]) => value !== undefined && value !== null && value !== '')\n    .map(([key, value]) => {\n      if (Array.isArray(value)) {\n        return value.map(v => `${encodeURIComponent(key)}=${encodeURIComponent(v)}`).join('&');\n      }\n      return `${encodeURIComponent(key)}=${encodeURIComponent(value)}`;\n    });\n  \n  return filtered.length > 0 ? `?${filtered.join('&')}` : '';\n} ","import type { ContraClientConfig, ContraFilters, ContraExpert, ContraApiResponse } from './types.js';\nimport { buildQueryString } from './utils.js';\n\nexport class ContraClient {\n  private apiKey: string;\n  private baseUrl: string;\n  private timeout: number;\n\n  constructor(config: ContraClientConfig) {\n    this.apiKey = config.apiKey;\n    this.baseUrl = config.baseUrl || 'https://api.contra.com/v1';\n    this.timeout = config.timeout || 10000;\n  }\n\n  /**\n   * Generic fetch wrapper with authentication and error handling\n   */\n  private async fetch<T>(endpoint: string, options: RequestInit = {}): Promise<T> {\n    const url = `${this.baseUrl}${endpoint}`;\n    \n    const controller = new AbortController();\n    const timeoutId = setTimeout(() => controller.abort(), this.timeout);\n\n    try {\n      const response = await fetch(url, {\n        ...options,\n        signal: controller.signal,\n        headers: {\n          'Authorization': `Bearer ${this.apiKey}`,\n          'Content-Type': 'application/json',\n          ...options.headers,\n        },\n      });\n\n      clearTimeout(timeoutId);\n\n      if (!response.ok) {\n        throw new Error(`API Error: ${response.status} ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      return data;\n    } catch (error) {\n      clearTimeout(timeoutId);\n      if (error instanceof Error && error.name === 'AbortError') {\n        throw new Error(`Request timeout after ${this.timeout}ms`);\n      }\n      throw error;\n    }\n  }\n\n  /**\n   * List experts with optional filters\n   */\n  async listExperts(\n    program: string,\n    filters: ContraFilters = {},\n    page = 1,\n    limit = 20\n  ): Promise<ContraApiResponse<ContraExpert[]>> {\n    const queryParams = {\n      program,\n      page,\n      limit,\n      ...filters,\n    };\n\n    const queryString = buildQueryString(queryParams);\n    const response = await this.fetch<ContraApiResponse<ContraExpert[]>>(`/experts${queryString}`);\n    \n    return response;\n  }\n\n  /**\n   * Get a single expert by ID\n   */\n  async getExpert(expertId: string): Promise<ContraExpert> {\n    const response = await this.fetch<{ data: ContraExpert }>(`/experts/${expertId}`);\n    return response.data;\n  }\n\n  /**\n   * Search experts by query string\n   */\n  async searchExperts(\n    query: string,\n    filters: ContraFilters = {},\n    page = 1,\n    limit = 20\n  ): Promise<ContraApiResponse<ContraExpert[]>> {\n    const queryParams = {\n      q: query,\n      page,\n      limit,\n      ...filters,\n    };\n\n    const queryString = buildQueryString(queryParams);\n    const response = await this.fetch<ContraApiResponse<ContraExpert[]>>(`/experts/search${queryString}`);\n    \n    return response;\n  }\n} ","import { ContraClient, starSVG } from \"@contra/contra-core\";\nimport type { ContraFilters, ContraExpert, ContraProject } from \"@contra/contra-core\";\n\nconst ATTR_PREFIX = \"data-contra-\";\n\n/* ----------------------- Helpers ----------------------- */\nconst attr = (el: Element, name: string) => el.getAttribute(`${ATTR_PREFIX}${name}`);\nconst qs   = <T extends HTMLElement>(el: Element, sel: string)   => el.querySelector(sel) as T | null;\nconst qsa  = <T extends HTMLElement>(el: Element, sel: string)  => Array.from(el.querySelectorAll(sel)) as T[];\n\n/* Parse wrapper â†’ ContraFilters */\nfunction parseFilters(wrapper: HTMLElement): ContraFilters {\n  const f: ContraFilters = {};\n  const map: Record<string, keyof ContraFilters> = {\"languages\":\"languages\",\"min-rate\":\"minRate\",\"max-rate\":\"maxRate\",\"location\":\"location\",\"available\":\"available\",\"sort\":\"sortBy\"};\n  Object.entries(map).forEach(([a,k])=>{\n    const v=attr(wrapper,a); if(v==null) return;\n    if(k==='languages') f.languages=v.split(',').map(s=>s.trim());\n    else if(k==='available') f.available=v==='true';\n    else if(k==='minRate'||k==='maxRate') (f as any)[k]=+v;\n    else (f as any)[k]=v;\n  });\n  return f;\n}\n\n/* Hydrate scalar + project repeat */\nfunction hydrateCard(tpl: HTMLElement, ex: ContraExpert): HTMLElement {\n  const c=tpl.cloneNode(true) as HTMLElement; c.removeAttribute('style');\n  // scalar fields\n  qsa<HTMLElement>(c,'[data-field]').forEach(el=>{\n    const key=el.dataset.field!; const val=(ex as any)[key]; if(val==null) return;\n    if(el.tagName==='IMG') (el as HTMLImageElement).src=val;\n    else if(el.tagName==='A') (el as HTMLAnchorElement).href=val;\n    else el.textContent = key==='hourlyRateUSD'?`$${val}/hr`:String(val);\n  });\n  // stars\n  qs(c,'[data-stars]')?.insertAdjacentHTML('beforeend',starSVG(ex.averageReviewScore));\n  // projects list\n  qsa<HTMLElement>(c,'[data-repeat=\"projects\"]').forEach(container=>{\n    const proto=container.firstElementChild?.cloneNode(true) as HTMLElement|undefined;\n    if(!proto) return;\n    container.innerHTML='';\n    const items=(ex.projects||[]).slice(0,4);\n    items.forEach((p: ContraProject)=>{\n      const clone=proto.cloneNode(true) as HTMLElement;\n      qsa<HTMLElement>(clone,'[data-field]').forEach(el=>{\n        const key=el.dataset.field!; const v=(p as any)[key]; if(v==null) return;\n        if(el.tagName==='IMG') (el as HTMLImageElement).src=v;\n        else if(el.tagName==='A') (el as HTMLAnchorElement).href=v;\n        else el.textContent=v;\n      });\n      container.appendChild(clone);\n    });\n    if(items.length===0) container.style.display='none';\n  });\n  return c;\n}\n\n/* Render experts into wrapper */\nasync function render(wrapper: HTMLElement, client: ContraClient){\n  qsa(wrapper,':scope>*:not([data-contra-template])').forEach(n=>n.remove());\n  const tpl=qs(wrapper,'[data-contra-template]')!; if(!tpl) return;\n  const program=attr(wrapper,'program')!; const filters=parseFilters(wrapper);\n  const {data}=await client.listExperts(program,filters);\n  data.forEach((ex: ContraExpert)=>wrapper.appendChild(hydrateCard(tpl,ex)));\n}\n\n/* Wire filter controls */\nfunction wireControls(wrapper: HTMLElement){\n  qsa(wrapper,`[${ATTR_PREFIX}filter]`).forEach(ctrl=>{\n    const key=attr(ctrl,'filter')!; const multi=ctrl instanceof HTMLSelectElement && ctrl.multiple;\n    ctrl.addEventListener('change',()=>{\n      if(ctrl instanceof HTMLInputElement && ctrl.type==='checkbox') wrapper.setAttribute(`${ATTR_PREFIX}${key}`,String(ctrl.checked));\n      else if(multi){const v=[...(ctrl as HTMLSelectElement).selectedOptions].map(o=>o.value).join(','); wrapper.setAttribute(`${ATTR_PREFIX}${key}`,v);} \n      else wrapper.setAttribute(`${ATTR_PREFIX}${key}`,(ctrl as HTMLInputElement|HTMLSelectElement).value);\n      (wrapper as any)._reload();\n    });\n  });\n}\n\n/* Boot */\nasync function main(){\n  const cfg=JSON.parse(document.getElementById('contra-config')!.textContent!);\n  const client=new ContraClient({apiKey:cfg.apiKey});\n  document.querySelectorAll(`[${ATTR_PREFIX}program]`).forEach(w=>{\n    const wrapper=w as HTMLElement; wrapper.style.position='relative';\n    (wrapper as any)._reload=()=>render(wrapper,client);\n    wireControls(wrapper); (wrapper as any)._reload();\n  });\n}\nif(document.readyState==='loading') document.addEventListener('DOMContentLoaded',main); else main(); "],"mappings":"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","names":["starSVG","score","fullStars","hasHalfStar","emptyStars","html","i","buildQueryString","params","filtered","_","value","key","v","ContraClient","config","endpoint","options","url","controller","timeoutId","response","error","program","filters","page","limit","queryParams","queryString","expertId","query","ATTR_PREFIX","attr","el","name","qs","sel","qsa","parseFilters","wrapper","f","a","k","v","hydrateCard","tpl","ex","c","key","val","starSVG","container","proto","items","p","clone","render","client","n","program","filters","data","wireControls","ctrl","multi","o","main","cfg","ContraClient","w"]}